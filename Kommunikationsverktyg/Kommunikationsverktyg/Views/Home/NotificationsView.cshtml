
@{
    ViewBag.Title = "Notiser";
}

<h2>Notiser</h2>

<div>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Mötesnamn</th>
                <th>Beskrivning</th>
                <th>Börjar</th>
                <th>Slutar</th>
                <th>Kan du delta?</th>
            </tr>
        </thead>
        <tbody id="events">

        </tbody>
    </table>
</div>

@section Scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

    <script>
        $(document).ready(function () {
            var table = $('#events');
            var events = [];
            $.ajax({
                type: "GET",
                url: "/Home/GetEventNotifications",
                success: function (data) {

                    $.each(data, function (i, v) {
                        console.log(moment(v.TimeSuggestions[0].StartTime).format('MMM Do YYYY HH:mm'));
                        var btnIdAccept = 1;
                        var btnIdDecline = 100;
                        table.append(
                            '<tr>' +
                            '<td>' + v.Title + '</td>' +
                            '<td>' + v.Description + '</td>' +
                            '<td>' + moment(v.TimeSuggestions[0].StartTime).format('MMM Do YYYY HH:mm') + '</td>' +
                            '<td>' + moment(v.TimeSuggestions[0].EndTime).format('MMM Do YYYY HH:mm') + '</td>' +
                            '<td><button value="Yes" class="btn btn-primary" id="'+ btnIdAccept +'">Ja</button>' +
                            '<button value="No" class="btn btn-danger" id="'+ btnIdDecline + '" style="margin-left: 5px;">Nej</button></td>' +
                            '</tr>'
                        );
                        console.log(v.Title);
                        btnIdAccept++;
                        btnIdDecline++;
                    })

                },
                error: function (error) {
                    alert('failed');
                }
            })
        });
        $(".btn btn-primary").click (function () {
            $(this).prop("disabled", true);
        })
    </script>

}

